# å­—ç¬¦ä¸²åŒ¹é…ä¸“é¢˜

å­—ç¬¦ä¸²åŒ¹é…ç®—æ³•ï¼ˆString matching algorithmsï¼‰æ˜¯å­—ç¬¦ä¸²é—®é¢˜ä¸‹çš„ä¸€ä¸ª**æœç´¢é—®é¢˜**ï¼Œå› æ­¤å®ƒæœ¬è´¨æ˜¯ä¸€ä¸ªæœç´¢é—®é¢˜ï¼Œä¸è¿‡å’Œæˆ‘ä»¬å‰é¢è®²çš„ BFSï¼ŒDFS ï¼Œ å›æº¯ä¸å¤ªä¸€æ ·ï¼Œè¿™äº›ä¾§é‡çš„æ˜¯å¯¹æœç´¢æ ‘è¿›è¡Œæœç´¢ï¼Œå³çŠ¶æ€ç©ºé—´æ˜¯éçº¿æ€§çš„ã€‚è€Œæœ¬ç« çš„çŠ¶æ€ç©ºé—´æ˜¯çº¿æ€§çš„ã€‚

## ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²åŒ¹é…

å­—ç¬¦ä¸²åŒ¹é…ç”¨æ¥åœ¨ä¸€é•¿å­—ç¬¦ä¸²æˆ–æ–‡ç« ä¸­ï¼Œæ‰¾å‡ºå…¶æ˜¯å¦åŒ…å«æŸä¸€ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ä¸²ä»¥åŠå…¶ä½ç½®çš„ç®—æ³•ã€‚è¯¥ç®—æ³•çš„åº”ç”¨éå¸¸å¹¿æ³›ï¼Œæ¯”å¦‚ï¼šç”Ÿç‰©åŸºå› åŒ¹é…ã€ä¿¡æ¯æ£€ç´¢ï¼ˆæ¯”å¦‚ç¼–è¾‘å™¨çš„ ctrl + f æœç´¢åŠŸèƒ½ï¼‰ç­‰ã€‚

ç”¨æ•°å­¦è¯­è¨€æè¿°å¦‚ä¸‹:

å‡è®¾TTæ˜¯ä¸€ä¸ªé•¿åº¦ä¸ºnnçš„æ–‡æœ¬ä¸²ï¼ŒPPæ˜¯é•¿åº¦ä¸ºmmçš„æ¨¡å¼ä¸²ã€‚å¦‚æœæœ‰ 0<=s<n-m0<=s<nâˆ’mï¼Œä½¿å¾—T[s, s+1,...,s+m-1]T[s,s+1,...,s+mâˆ’1]ç­‰äºPPï¼Œåˆ™ç§°PPåœ¨TTä¸­å‡ºç°ä¸”ä½ç§»ä¸ºssã€‚

æ¯”å¦‚ T ä¸º "lucifer"ï¼Œ "lu"ï¼ˆå¼€å§‹ä½ç½®ä¸º 0ï¼‰ï¼Œ "cifer"ï¼ˆå¼€å§‹ä½ç½®ä¸º 2ï¼‰ åœ¨ T ä¸­å‡ºç°è¿‡ã€‚è€Œ "xifa"ï¼Œ "hello" ç­‰æ²¡æœ‰åœ¨ T ä¸­å‡ºç°è¿‡ã€‚

## å­—ç¬¦ä¸²åŒ¹é…å¸¸è§ç®—æ³•

### æš´åŠ›(Brute Force)

åœ¨æ—¥å¸¸ç¼–ç ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬è‚¯å®šä¼šé‡åˆ°ç±»ä¼¼çš„é—®é¢˜ï¼Œå¤§éƒ¨åˆ†æ•°æ®é‡å…¶å®**ä¸å¤§**ï¼Œä¸²é•¿ä¹Ÿ**è¾ƒçŸ­**ï¼Œå› æ­¤è‡ªç„¶ä¼šæƒ³åˆ°**çª—å£å¤§å°å›ºå®šçš„æ»‘åŠ¨çª—å£**æ‰¾å‡ºæ‰€æœ‰å­ä¸²å¹¶ä¾æ¬¡å’Œæ¨¡å¼ä¸²æŒ‰å­—æ¯é¡ºåºä¾æ¬¡æ¯”å¯¹çœ‹æ˜¯å¦åŒ¹é…å¹¶è®°å½•ã€‚

> è¿™é‡Œçš„çª—å£å¤§å°å°±æ˜¯æ¨¡å¼ä¸²çš„é•¿åº¦

Brute Force æœ‰æ—¶å€™ä¹Ÿç®€ç§°ä¸º BFã€‚å…¶æ ¸å¿ƒæ€è·¯éå¸¸æœ´ç´ ã€‚è¯¥ç®—æ³•å¯ä»¥æŠ½è±¡ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š

1. 

   éæ³•æƒ…å†µå¤„ç†ï¼Œå¦‚æ¨¡å¼ä¸²é•¿åº¦å¤§äºå¾…åŒ¹é…ä¸²ç­‰ï¼ˆé˜²å¾¡æ€§ç¼–ç¨‹)

   

2. 

   åˆå§‹åŒ–å¤§å°ä¸ºæ¨¡å¼ä¸²é•¿çš„æ»‘çª—

   

3. 

   å›ºå®šå½“å‰çª—å£ï¼Œå°†å½“å‰çª—å£çš„å­ä¸²ä¸æ¨¡å¼ä¸²åŒ¹é…

   2.1. è‹¥åŒ¹é…æˆåŠŸï¼Œåˆ™è®°å½•ç›¸å…³ä¿¡æ¯ï¼Œå¦‚è¯¥ä½ç½®ä¸‹æ ‡

   2.2. å¦åˆ™çª—å£å‘åç§»åŠ¨ä¸€æ ¼

   

**ä¼ªä»£ç **

```
n = length[T]
m = length[P]

for s = 0 to n - m
  do if T[s..s+m] == P
    save info
```

æ—¶é—´å¤æ‚åº¦O(n*m)O(nâˆ—m), ç©ºé—´å¤æ‚åº¦O(1)O(1)

è¿™ç§æš´åŠ›ç®—æ³•å¯¹äºæ•°æ®è§„æ¨¡å°ï¼Œä¸²çŸ­çš„é—®é¢˜å·²ç»è¶³å¤Ÿäº†ï¼Œä½†æ˜¯å¾ˆå¤šåœºæ™¯ä¸‹æ•°æ®è§„æ¨¡å¾ˆå¤§ï¼Œé‚£æš´åŠ›ç®—æ³•å°±æ˜¾å¾—æ‰è¥Ÿè§è‚˜äº†ï¼Œæ¯•ç«Ÿæ—¶é—´å¤æ‚åº¦æ‘†åœ¨é‚£é‡Œï¼Œå“åº”æ—¶é—´è¿‡é•¿ã€‚

æˆ‘ä»¬ç¨åŠ åˆ†æå…¶å®ä¸éš¾å‘ç°ï¼Œæˆ‘ä»¬åœ¨æ¯æ¬¡çª—å£åç§»ä¸€ä½è¿›è¡ŒåŒ¹é…çš„æ—¶å€™ï¼Œå®é™…ä¸Šæ˜¯æŠŠ**ä¸Šä¸€ä¸ªçª—å£çš„æ‰€æœ‰çŠ¶æ€ä¿¡æ¯å…¨éƒ¨éƒ½ä¸¢æ‰ä¸è¦äº†**ï¼Œè¿™ä¼šé€ æˆä¿¡æ¯çš„æµªè´¹ï¼Œé‚£ä¹ˆéƒ½æœ‰å“ªäº›å¸¸è§ä¸”ä¼˜ç§€çš„è§£å†³æ–¹æ¡ˆå‘¢ï¼Ÿ

æ ¸å¿ƒå…¶å®è¿˜æ˜¯å‰é¢è®²æ»‘åŠ¨çª—å£æåˆ°çš„**å˜åŒ–ä»…ä»…æ˜¯çª—å£è¾¹ç¼˜ï¼Œçª—å£ä¸­é—´ä¸å˜**ã€‚è¿™å°±æ˜¯ RK ç®—æ³•çš„æœ¬è´¨ã€‚

### Rabin-Karp ç®—æ³•(RK)

**è¿™ä¸ªæ–¹æ³•æ˜¯æœ¬èŠ‚æœ€æœ€æ¨èæŒæ¡çš„ä¸€ä¸ªæ–¹æ³•ã€‚å…¶ä»–æ–¹æ³•å¯ä»¥ä¸æŒæ¡ï¼Œä½†è¿™ä¸ªè§£æ³•åŠ¡å¿…æŒæ¡ã€‚**

**æ ¸å¿ƒæ€è·¯**

RK ç®—æ³•ä¸»è¦æ˜¯å¯¹TTä¸­æ¯ä¸ªé•¿åº¦ä¸ºmmçš„å­å­—ç¬¦ä¸²T[s..s+m]T[s..s+m]è¿›è¡Œ hash è¿ç®—ï¼Œç”Ÿæˆ hash å€¼h1h1ï¼Œå¯¹PPè¿›è¡Œ hash è¿ç®—ï¼Œç”Ÿæˆ hash å€¼h2h2, æ¯”å¯¹h1h1å’Œh2h2ï¼Œå¦‚æœä¸¤ä¸ª hash å€¼( ä¸è€ƒè™‘å†²çª)ç›¸ç­‰ï¼Œåˆ™åˆ¤æ–­PPåœ¨TTä¸­å‡ºç°ï¼Œä¸”ä½ç§»ä¸ºssã€‚

è¯¥ç®—æ³•éœ€è¦å¯¹ P è®¡ç®—ä¸€æ¬¡å“ˆå¸Œï¼Œå¹¶å¯¹ T è®¡ç®— n - m + 1 æ¬¡å“ˆå¸Œã€‚è€Œè®¡ç®—å“ˆå¸Œçš„å¤æ‚åº¦å’Œ**è¢«è®¡ç®—å“ˆå¸Œçš„å­—ç¬¦ä¸²**é•¿åº¦çº¿æ€§ç›¸å…³ï¼Œæ¯æ­¥ hash çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(m)O(m)ã€‚ åœ¨è¿™é‡Œè¢«è®¡ç®—å“ˆå¸Œçš„å­—ç¬¦ä¸²é•¿åº¦ä¸º mï¼Œå› æ­¤**å¦‚æœä»…ä»…ä½¿ç”¨å“ˆå¸Œï¼Œè€Œä¸å¯¹ç®—æ³•è¿›è¡Œä»»ä½•å…¶ä»–ä¼˜åŒ–çš„è¯**æ€»çš„æ—¶é—´å¤æ‚åº¦å’Œå‰é¢æåˆ°çš„æš´åŠ›æ³•ä¸€æ ·ï¼Œæœ€åçš„æ•´ä½“å¤æ‚åº¦å’Œ BF ä¸€æ ·éƒ½ä¸ºO(m*n)O(mâˆ—n)ã€‚

RK ç®—æ³•å¦™åœ¨æ»‘åŠ¨çª—å£çš„æ—¶å€™ï¼Œè®¾è®¡äº†ä¸€ä¸ªé€‚åˆçš„å“ˆå¸Œå‡½æ•°ï¼Œæœ‰æ•ˆä¿ç•™äº†ä¸Šä¸€ä¸ªçŠ¶æ€çš„éƒ¨åˆ†ä¿¡æ¯ï¼Œè¿™æ ·**ç¬¬ä¸€æ¬¡**è®¡ç®—å­ä¸² hash å€¼æ—¶é—´å¤æ‚åº¦ä¸ºO(m)O(m)ï¼Œè€Œ**åç»­å°±å¯ä»¥è¾¾åˆ°O(1)O(1)**ã€‚RK ç®—æ³•æœ€ç»ˆçš„æ—¶é—´å¤æ‚åº¦å°±é™ä¸ºO(m+n)O(m+n)ã€‚

è¿™å°±æ˜¯**æœ‰æ•ˆåˆ©ç”¨äº†å‰é¢è®¡ç®—çš„çª—å£ä¿¡æ¯ï¼Œè€Œä¸æ˜¯å…¨ç›˜è®¡ç®—ã€‚è¿™ä¸å°±æ˜¯æ»‘åŠ¨çª—å£çš„ç²¾é«“ä¹ˆï¼Ÿ**ã€‚

è¯¥æ–¹æ³•å¯ä»¥æŠ½è±¡ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š

1. 

   éæ³•æƒ…å†µå¤„ç†ï¼Œå¦‚æ¨¡å¼ä¸²é•¿åº¦å¤§äºå¾…åŒ¹é…ä¸²ç­‰ï¼ˆé˜²å¾¡æ€§ç¼–ç¨‹ï¼‰

   

2. 

   è®¡ç®—å‡ºæ¨¡å¼ä¸² hash å€¼

   

3. 

   åˆå§‹åŒ–å¤§å°ä¸ºæ¨¡å¼ä¸²é•¿çš„æ»‘çª—å¹¶è®¡ç®—å‡º hash å€¼ï¼Œåˆ¤æ–­å½“å‰ hash å€¼æ˜¯å¦å’Œæ¨¡å¼ä¸² hash å€¼ç›¸ç­‰ã€‚

   2.1. è‹¥ç›¸ç­‰ï¼Œåˆ™è®°å½•ç›¸å…³ä¿¡æ¯ï¼Œå¦‚è¯¥ä½ç½®ä¸‹æ ‡

   2.2. å¦åˆ™çª—å£å‘åç§»åŠ¨ä¸€æ ¼ï¼Œå¹¶å†æ¬¡è®¡ç®— hash å€¼ï¼ˆæ­¤å¤„åˆ©ç”¨ä¸Šä¸ªçŠ¶æ€å¯ç›´æ¥ä¸€æ­¥è®¡ç®—ï¼‰

   

**ä¼ªä»£ç **

```
n = length[T]
m = length[P]
hp = hash(P)

for s = 0 to n - m
  hs = hash(T[s..s+m])
  if hp == hs and double check is right
    save info
```

![img](https://p.ipic.vip/5lsaam.jpg)ç¤ºæ„å›¾

æˆ‘ä»¬è¿™é‡Œé€‰å–çš„å“ˆå¸Œå‡½æ•°ä¸ºï¼šf(P)=Pè¡¨ç¤ºçš„10è¿›åˆ¶å€¼f(P)=Pè¡¨ç¤ºçš„10è¿›åˆ¶å€¼ã€‚

> æ¥ä¸‹æ¥çš„é¢˜ç›®ä¸­ï¼Œå“ˆå¸Œå‡½æ•°å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼Œæ¯”å¦‚ 26 è¿›åˆ¶å€¼æ¥è®¡ç®—ä»…å« 26 ä¸ªè‹±æ–‡å­—æ¯çš„å­—ç¬¦ä¸²çš„å“ˆå¸Œã€‚

å‡è®¾PPå’ŒTTå…¨ç”±ddä¸ªå­—ç¬¦ç»„æˆçš„ï¼ˆä¹Ÿå°±æ˜¯è¯´å­—ç¬¦é›†å¤§å°ä¸º dï¼‰ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥é€‰æ‹©ddè¿›åˆ¶è¡¨ç¤ºPPå’ŒTTï¼Œå†å°†ddè¿›åˆ¶è½¬ä¸º1010è¿›åˆ¶ä¾¿äºè®¡ç®—ã€‚

ä¸ºäº†ç®€åŒ–è¯´æ˜ï¼Œæˆ‘ä»¬æ›´ç‰¹æ®Šåœ°å‡è®¾PPå’ŒTTå…¨ç”±[0-9]10 ä¸ªæ•°å­—ç»„æˆã€‚

PPçš„ 10 è¿›åˆ¶ä¸ºï¼š

```
f(P) = P[0] * 10 ^ (m - 1) + P[1] * 10 ^ (m - 2) ... + P[m-1]*10^0
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä»£å…¥ä¸Šé¢çš„å“ˆå¸Œå‡½æ•°è®¡ç®— T çš„æ‰€æœ‰å­ä¸²çš„å“ˆå¸Œå€¼ã€‚

T[s..s+m]T[s..s+m]çš„ 10 è¿›åˆ¶ä¸º:

```
f(T[s..s + m]) = T[s] * 10 ^ (m - 1) + T[s + 1] * 10 ^ (m - 2) ... + T[s + m - 1]
```

ç›¸åº”åœ°ï¼Œä¸‹ä¸€ä¸ªå­—ç¬¦ä¸²T[s+1..s+m]T[s+1..s+m]çš„å“ˆå¸Œå€¼å¯ä»¥æ ¹æ®å‰é¢è®¡ç®—å¥½çš„T[s..s+m-1]T[s..s+mâˆ’1]çš„å“ˆå¸Œå€¼æ¨å¯¼å‡ºæ¥ã€‚å³**åŠ ä¸Šçª—å£ä¸­æ–°å¢åŠ çš„å­—ç¬¦çš„å“ˆå¸Œå€¼è´¡çŒ®ï¼Œå†å‡å»çª—å£ä¸­ç§»é™¤çš„å­—ç¬¦çš„å“ˆå¸Œå€¼è´¡çŒ®**

è¯¥å“ˆå¸Œç®—æ³•æ˜¯å°†å­—ç¬¦ä¸²çš„æ¯ä¸€ä¸ªä½çš„å­—ç¬¦è½¬æ¢æˆå¯¹åº”çš„æ•°å­—ï¼Œå†æ ¹æ®ä¸€å®šçš„æƒé‡ï¼ˆè¿™é‡Œæ˜¯ 10ï¼‰ç›¸ä¹˜å¾—åˆ°ä¸€ä¸ªæ•°å€¼ã€‚

å…·ä½“è¿‡ç¨‹å¦‚ä¸‹ï¼š

```
f(T[s+1..s + m]) = T[s+1] * 10 ^ (m - 1) + T[s + 2] * 10 ^ (m - 2) ... + T[s + m]
= (f(T[s..s + m]) - T[s] * 10 ^ (m - 1)) * 10 + T[s + m ]
```

è¿™æ ·å°±æŠŠä»¥ä¸Š `hp === hs` çš„å“ˆå¸Œæ¯”è¾ƒè½¬åŒ–ä¸ºæ­£å¸¸çš„ 10 è¿›åˆ¶æ¯”è¾ƒã€‚

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä»¥ä¸Šå‡è®¾æˆ‘ä»¬å›é¿çš„ä¸€ä¸ªé—®é¢˜æ˜¯å¦‚æœf(P)f(P)æˆ–è€…f(T)f(T)è®¡ç®—çš„ 10 è¿›åˆ¶è¿‡å¤§ï¼Œå¯¼è‡´**è¿ç®—æº¢å‡º**æ€ä¹ˆåŠï¼Ÿæ¯”å¦‚æˆ‘ä»¬ç”¨ 32 ä½æ•´å½¢å­˜å‚¨å“ˆå¸Œå€¼ï¼Œé‚£ä¹ˆå¦‚æœè®¡ç®—çš„å“ˆå¸Œå€¼è¶…è¿‡äº† 32 ä½æ•´å½¢æ‰€èƒ½è¡¨ç¤ºçš„ä¸Šé™æ€ä¹ˆåŠï¼Ÿ

å³ä½¿åœ¨ Python ç­‰æ”¯æŒå¤§æ•°çš„è¯­è¨€ï¼Œæˆ‘ä»¬ä¸ä¼šé‡åˆ°æº¢å‡ºé—®é¢˜ã€‚è¿™ç§ç®—æ³•åŒæ ·æœ‰é—®é¢˜ï¼Œå› ä¸ºè¿™ç§ç®—æ³•æ€§èƒ½ä¼šéšç€è®¡ç®—çš„å“ˆå¸Œå€¼å˜å¤§è€Œé™ä½ã€‚

å¦‚ä½•è§£å†³æº¢å‡ºå’Œæ€§èƒ½é—®é¢˜å‘¢ï¼Ÿ

è¿™é‡Œæˆ‘ä»¬é€šè¿‡é€‰æ‹©ä¸€ä¸ªæ¯”è¾ƒå¤§çš„ç´ æ•°qq, è®¡ç®—åçš„ 10 è¿›åˆ¶æ•°å¯¹qq**å–æ¨¡å**å†è¿›è¡Œæ¯”è¾ƒã€‚ ç”±äºæˆ‘ä»¬ä½¿ç”¨å¯¹ q å–æ¨¡ï¼Œå› æ­¤ç†è®ºä¸Šæ¥å¿…ç„¶ä¼šæœ‰å†²çªçš„æƒ…å†µï¼Œå¹¶ä¸”å†²çªçš„å¹³å‡ä¸ªæ•° n/qã€‚

å–æ¨¡çš„ä½œç”¨æ˜¯é˜²æ­¢æº¢å‡ºä»¥åŠæä¾›æ€§èƒ½ã€‚ä½†æ˜¯æœ‰å†²çªçš„å¯èƒ½ï¼Œf(P)%q==f(T[s])%qf(P)å¹¶ä¸èƒ½ä»£è¡¨f(P)==f(T[s])f(P)==f(T[s])ã€‚å› æ­¤ä»»ä½•çš„f(P)%q===f(T[s])%qf(P)éƒ½éœ€è¦é¢å¤–è¿›è¡Œå†æ¬¡éªŒè¯, è¿™é‡Œæˆ‘ä»¬é€šè¿‡æ£€æµ‹P==T[s..s+m]P==T[s..s+m]æ¥å®Œæˆã€‚

ä»è¿™é‡Œæœ‰å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœæˆ‘ä»¬çš„ä»£ç å†²çªå¾ˆå¤šï¼Œé‚£ä¹ˆæ•ˆç‡å’Œæš´åŠ›æ³•ç›¸å·®æ— å‡ ã€‚æç«¯æƒ…å†µï¼Œæ¯æ¬¡éƒ½å“ˆå¸Œå†²çªï¼Œé‚£ä¹ˆç®—æ³•æ•ˆç‡å’Œæš´åŠ›è§£ä¸€æ ·ï¼Œå¦‚æœç®—æ³•è®¡ç®—å“ˆå¸Œå€¼çš„å¼€é”€ï¼Œé‚£ä¹ˆæ•ˆç‡ä¼šæ¯”æš´åŠ›æ³•æ›´å·®ã€‚

å› æ­¤è®¾è®¡ä¸€ä¸ªå¥½çš„å“ˆå¸Œç®—æ³•ï¼Œå‡å°‘å†²çªæ˜¯å…³é”®ã€‚å¦‚æœä½ æ˜¯å‚åŠ é¢è¯•æˆ–è€…æ¯”èµ›åˆ™å¯ä»¥å°è¯•ä¸åŒçš„æ¨¡æ•°æ¥**è°ƒå‚**ï¼Œç›´åˆ°é€šè¿‡æ‰€æœ‰çš„æµ‹è¯•ç”¨ä¾‹ã€‚ä¸è¿‡è¿™ç§åšæ³•éå¸¸ä¸å»ºè®®åœ¨å·¥ç¨‹ä¸­ä½¿ç”¨ï¼Œå³ä½¿åœ¨é¢è¯•ä¸­ï¼Œä¹Ÿå¸Œæœ›ä½ èƒ½å…ˆå’Œé¢è¯•å®˜è¿›è¡Œæ²Ÿé€šä¹‹åå†åšå†³å®šã€‚

å¸¸è§çš„æ¯”è¾ƒå¤§çš„ç´ æ•°ä¸º ${10**9 + 7}ï¼Œä¸ºäº†æé«˜æ€§èƒ½å¯ä»¥é€‰å–æ›´å°çš„ç´ æ•°ã€‚

é¢˜ç›®æ¨èï¼š

- [5803. æœ€é•¿å…¬å…±å­è·¯å¾„](https://leetcode-cn.com/problems/longest-common-subpath/)

æ€»çš„æ¥è¯´ï¼ŒRK ç®—æ³•å°±æ˜¯ï¼šå“ˆå¸Œå‡½æ•° + æ»‘åŠ¨çª—å£ã€‚ä½¿ç”¨å“ˆå¸Œå‡½æ•°ä½¿å¾—æˆ‘ä»¬åç»­å¯ä»¥åœ¨ O(1)O(1) çš„æ—¶é—´è®¡ç®—å­—ç¬¦ä¸²çš„å“ˆå¸Œå€¼ã€‚

æ‰©å±•ï¼š

- å¦‚æœåŒ¹é… T çš„ä»»æ„ä¸€æ®µå­—ç¬¦ä¸²ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ç»“åˆå‰ç¼€å’Œçš„æŠ€å·§æ¥å®Œæˆã€‚`prefix[i] = prefix[i-1] * base + s[i]`ï¼Œ è¿™æ ·å­ä¸² s[i:j] çš„å‰ç¼€å°±æ˜¯ `prefix[j] - prefix[i-1] * base ** (j - i + 1)`ã€‚ æ¨èé¢˜ç›® [6036. æ„é€ å­—ç¬¦ä¸²çš„æ€»å¾—åˆ†å’Œ](https://leetcode-cn.com/problems/sum-of-scores-of-built-strings/)

### KMP

> å»ºè®®å…ˆè§‚çœ‹æ–‡æœ«æ‰©å±•éƒ¨åˆ†çš„è§†é¢‘åå†æ¥è¯»è®²ä¹‰ã€‚

**KMP æœ¬è´¨ä¸Šæ˜¯ä¸ªé¢„å¤„ç† + dpã€‚**

- é¢„å¤„ç†æŒ‡çš„æ˜¯ç»è¿‡è¿™æ ·çš„å¤„ç†ä¸€ä¸ªæ¨¡å¼ä¸²ä¼šç”Ÿæˆä¸€ä¸ª **å”¯ä¸€çš„ next æ•°ç»„**ï¼Œä»è€Œå¯ä»¥å»åŒ¹é…ä»»æ„çš„ä¸»ä¸²ã€‚

> å”¯ä¸€æŒ‡çš„æ˜¯ç»™å®šæ¨¡å¼ä¸²ï¼Œç”Ÿæˆçš„ next æ•°ç»„å°±æ˜¯ç¡®å®šçš„ã€‚å’Œä¸»ä¸²æ˜¯æ²¡æœ‰ä»»ä½•å…³ç³»çš„ã€‚

- dp æŒ‡çš„æ˜¯å»ºç«‹ next æ•°ç»„çš„éƒ¨åˆ†ä½¿ç”¨åˆ°äº†åŠ¨æ€è§„åˆ’çš„ç®—æ³•ã€‚

è€ŒåŒ¹é…çš„è¿‡ç¨‹ï¼Œæš´åŠ›ï¼ˆBFï¼‰ç®—æ³•ä¸­ä¸»ä¸²ä¼šæœ‰å¾ˆå¤šå›æº¯ï¼Œä½¿ç”¨ KMP å¯ä»¥**é¿å…ä¸»ä¸²å›æº¯ï¼Œè€Œåªå›æº¯æ¨¡å¼ä¸²**ã€‚ å½¢è±¡åœ°çœ‹å°±æ˜¯æ¨¡å¼ä¸²ä¸åœåœ°åœ¨å¯¹é½ä¸»ä¸²ã€‚

**æ ¸å¿ƒæ€è·¯**

é¦–å…ˆæˆ‘ä»¬å®šä¹‰æ¨¡å¼ä¸²çš„å‰ç¼€å‡½æ•° f(i) ä¸º æ¨¡å¼ä¸² P ä¸­ P[1...i]ç›¸åŒå‰ç¼€åç¼€çš„æœ€å¤§é•¿åº¦ã€‚å¯¹ P[1...m]ä¸­çš„æ¯ä¸ª iï¼Œ(i > 0 && i <= m), ç”¨ä¸€ä¸ªæ•°ç»„ next è®°å½•ã€‚ KMP ç®—æ³•ç”± Knuthï¼ŒMorris å’Œ Pratt ä¸‰ä¸ªå¤§ä½¬è”åˆå‘æ˜ï¼ŒKMP ç®—æ³•åå­—ç”±ä¸‰ä¸ªå¤§ä½¬åå­—é¦–ä½å­—ç¬¦ç»„æˆã€‚

é¦–å…ˆæˆ‘ä»¬å®šä¹‰æ¨¡å¼ä¸²çš„å‡½æ•°f(i)f(i)ä¸ºæ¨¡å¼ä¸²PPä¸­P[:i]P[:i]ç›¸åŒå‰ç¼€åç¼€çš„æœ€å¤§é•¿åº¦ã€‚å¯¹PPä¸­çš„æ¯ä¸ªiiçš„ä¿¡æ¯ï¼Œç”¨ä¸€ä¸ªæ•°ç»„nextnextç»Ÿä¸€è®°å½•ã€‚ KMP ç®—æ³•åœ¨æ¯æ¬¡å¤±é…åï¼Œä¼šæ ¹æ®ä¸Šä¸€æ¬¡çš„æ¯”å¯¹ä¿¡æ¯è·³è½¬åˆ°ç›¸åº”çš„sså¤„ï¼Œå€ŸåŠ©çš„å°±æ˜¯ä¸Šè¿°çš„nextnextæ•°ç»„ã€‚æ¨å¯¼è¿‡ç¨‹å¯ä»¥å‚è€ƒ [ä»å¤´åˆ°å°¾å½»åº•ç†è§£ KMP](https://blog.csdn.net/v_JULY_v/article/details/7041827)ï¼Œä¸ªäººè§‰å¾—è¿™ç¯‡è®²çš„éå¸¸é€å½»ï¼Œè¿™é‡Œå°±ä¸ç­é—¨å¼„æ–§äº†ã€‚è¯¥æ–¹æ³•å¯ä»¥æŠ½è±¡ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š

- éæ³•æƒ…å†µå¤„ç†ï¼Œå¦‚æ¨¡å¼ä¸²é•¿åº¦å¤§äºå¾…åŒ¹é…ä¸²ç­‰ï¼ˆé˜²å¾¡æ€§ç¼–ç¨‹ï¼‰
- è®¡ç®—å‡ºæ¨¡å¼ä¸²çš„ next æ•°ç»„ã€‚
- å¼€å§‹ä»å¾…åŒ¹é…ä¸²å¼€å§‹è¿›è¡ŒåŒ¹é…
- è‹¥åŒ¹é…æˆåŠŸï¼Œåˆ™è®°å½•ç›¸å…³ä¿¡æ¯ï¼›è‹¥å¤±é…ï¼Œåˆ™æŒ‰ next æ•°ç»„å›é€€åˆ°ä¸Šä¸€ä¸ªå¾…åŒ¹é…çŠ¶æ€ç»§ç»­è¿›è¡ŒåŒ¹é…

ä»¥ä¸‹æ˜¯è®¡ç®—nextnextæ•°ç»„çš„ä¼ªä»£ç 

```
get_next(P):
  m  = P.length
  ä½¿å¾— next ä¸ºé•¿åº¦ä¸ºmçš„æ•°ç»„
  next[1] = 0
  k = 0
  for i = 2 to m
    while(k > 0 å¹¶ä¸” P[k+1] != P[i])
      k = next[k]
    if P[k+1] == P[i]
      k = k + 1
    next[i] = k
  return next
```

ä»¥ä¸‹æ˜¯ KMP çš„ä¼ªä»£ç 

```
KMP(T, P)
  n = T.length
  m = P.length
  next = getNext(P)
  q = 0
  for let i = 1 to n:
    while(q > 0 å¹¶ä¸” P[q + 1] !== T[i])
      q = next[q]
    if P[q + 1] == T[i]
      q = q + 1
    if (q == m)
      æ‰¾åˆ°åŒ¹é…ä½ç§» s = i
```

## ä»€ä¹ˆæ—¶å€™éœ€è¦ç”¨åˆ°æˆ‘ä»¬è¿™èŠ‚è®²åˆ°çš„å­—ç¬¦ä¸²åŒ¹é…ç®—æ³•ï¼Ÿ

ä¸€èˆ¬æ¥è¯´ï¼Œ ç¬¦åˆä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶æˆ‘ä»¬å°±åº”è¯¥è€ƒè™‘ä½¿ç”¨ï¼š

1. æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²åŒ¹é…é—®é¢˜ã€‚ å³ä½ çš„ç®—æ³•ä¸­æœ‰ä¸€éƒ¨åˆ†æ˜¯**åˆ¤æ–­ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰**
2. å¸¸è§„çš„çº¿æ€§å­—ç¬¦ä¸²åŒ¹é…ä¼šè¶…æ—¶ã€‚

ä½ å¯ä»¥æŠŠè¿™ä¸ªè¿‡ç¨‹ç±»æ¯”æˆï¼š å¦‚æœé‡åˆ°ä¸€ä¸ªé¢˜ç›®éœ€è¦åœ¨çº¿æ€§è¡¨ä¸­æœç´¢ä¸€ä¸ªå€¼ï¼Œ é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†å…¶å­˜åˆ°å“ˆå¸Œè¡¨ä¸­ä»è€Œä¼˜åŒ–æŸ¥è¯¢æ—¶é—´ã€‚

æ¯”å¦‚ [1316. ä¸åŒçš„å¾ªç¯å­å­—ç¬¦ä¸²](https://leetcode.cn/problems/distinct-echo-substrings/) è¿™é“é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥æšä¸¾æ‰€æœ‰çš„å­å­—ç¬¦ä¸²ï¼Œ è¿™éœ€è¦å¹³æ–¹çš„å¤æ‚åº¦ï¼Œ ç„¶ååˆ¤æ–­æ‰€æœ‰çš„å­—ç¬¦ä¸²æ˜¯å¦æ˜¯â€å¾ªç¯å­—ç¬¦ä¸²â€ï¼Œè¿™éœ€è¦çº¿æ€§çš„æ—¶é—´ã€‚

æˆ‘ä»¬å¯ä»¥é‡‡ç”¨ç±»ä¼¼ RK çš„ç®—æ³•ï¼Œ å¯¹åŸå§‹å­—ç¬¦ä¸²è¿›è¡Œä¸€ä¸ªå“ˆå¸Œç¼–ç ï¼Œ ç„¶åä½¿ç”¨ç±»ä¼¼å‰ç¼€å’Œçš„æŠ€å·§ä»è€Œå¯ä»¥åœ¨å¸¸æ•°æ—¶é—´æ±‚å‡ºä»»æ„å­ä¸²çš„å“ˆå¸Œå€¼ï¼Œ ç„¶åæˆ‘ä»¬é€šè¿‡å“ˆå¸Œå€¼è¿›è¡ŒåŒ¹é…å°±å¯ä»¥å°†ä¸Šé¢çš„çº¿æ€§åŒ¹é…ä¼˜åŒ–ä¸ºå¸¸æ•°åŒ¹é…ã€‚

## ç›¸å…³ä¸“é¢˜

### å­åºåˆ—åŒ¹é…

å’Œå­—ç¬¦ä¸²ä¸åŒï¼Œä¸€ä¸ªå­—ç¬¦ä¸² t æ˜¯å­—ç¬¦ä¸² s çš„å­åºåˆ—æ—¶ï¼Œæ»¡è¶³åˆ é™¤ s ä¸­çš„è‹¥å¹²å­—ç¬¦ï¼ˆä¹Ÿå¯ä»¥ä¸åˆ é™¤ï¼‰åå¯ä»¥ä½¿å¾— tã€‚æ¯”å¦‚ "abc" æ˜¯ "akbqc" çš„å­åºåˆ—ï¼Œä½†æ˜¯ "abc" å´ä¸æ˜¯ "akbqc" çš„å­ä¸²ã€‚

é‚£ä¹ˆç¬¬ä¸€ä¸ªé—®é¢˜å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå­—ç¬¦ä¸² t æ˜¯å¦æ˜¯å¦å¤–ä¸€ä¸ªå­—ç¬¦ä¸² s çš„å­åºåˆ—å‘¢ï¼Ÿæ˜¾ç„¶æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å­—ç¬¦ä¸²åŒ¹é…ç®—æ³•çš„æ€è·¯ï¼Œå¹¶åŠ ä»¥è°ƒæ•´ã€‚

å…·ä½“åœ°ï¼Œæˆ‘ä»¬åˆå§‹åŒ–ä¸¤ä¸ªæŒ‡é’ˆ i å’Œ j åˆ†åˆ«æŒ‡å‘ t å’Œ s çš„å¼€å§‹ä½ç½®ï¼Œ æ¥ä¸‹æ¥æ¯”è¾ƒ t[i] å’Œ s[j]ï¼Œå¦‚æœå¯ä»¥åŒ¹é…ï¼Œæˆ‘ä»¬**è´ªå¿ƒ**åœ°å°† i ç§»åŠ¨ä¸€ä½ã€‚ å¦‚æœæˆ‘ä»¬é€šè¿‡è¿™æ ·çš„ç§»åŠ¨æ–¹å¼åŠ  i ç§»åŠ¨åˆ° t çš„æœ«å°¾ï¼Œé‚£ä¹ˆå°±è¯´æ˜ t ä¸º s çš„å­åºåˆ—ã€‚

> è¿™é‡Œè´ªå¿ƒæˆåŠŸçš„åŸå› æ˜¯å¦‚æœåé¢å†è¿›è¡ŒåŒ¹é… t[i] çš„è¯ï¼Œä¸€å®šä¸ä¼šæ¯”ç°åœ¨å°±åŒ¹é…ç»“æœæ›´å¥½

```
def t(t, s):
  i = j = 0

  while i < len(t) and j < len(s):
    if t[i] == s[j]:
      i += 1
      if i == len(t): return True
    j += 1
  return False
```

æ¨èé¢˜ç›®ï¼š[392. åˆ¤æ–­å­åºåˆ—](https://leetcode.cn/problems/is-subsequence/)

å¦å¤–ä¸€ä¸ªå…³äºå­åºåˆ—çš„é¢˜å‹æ˜¯ï¼Œå¦‚æœå…è®¸ä½ åˆ é™¤ t ä¸­çš„ä¸€ä¸ªå­ä¸²ï¼Œä»è€Œä½¿å¾— t æ˜¯ s çš„å­åºåˆ—ã€‚é‚£ä¹ˆé—®ä½ éœ€è¦åˆ é™¤çš„**æœ€çŸ­**å­ä¸²çš„é•¿åº¦ã€‚å¦‚æœä¸éœ€è¦åˆ é™¤ï¼Œé‚£è¿”å› 0 ã€‚

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å‰ç¼€+åç¼€çš„æ–¹å¼æ¥è§£å†³ã€‚

```
pre = [len(s)+1] * (len(t))# pre[i] è¡¨ç¤ºåŒ¹é… s[:i] éœ€è¦çš„ s çš„å‰ç¼€é•¿åº¦
suf = [len(s)+1] * (len(t)) # suf[i] è¡¨ç¤ºåŒ¹é… s[i:] éœ€è¦çš„ s çš„åç¼€é•¿åº¦
```

æœ‰äº† pre å’Œ suf æ•°ç»„ï¼Œæˆ‘ä»¬å°±å¯ä»¥æšä¸¾åˆ é™¤çš„å­ä¸²é•¿åº¦ midã€‚å¯¹äºç»™å®šçš„åˆ é™¤å­ä¸²é•¿åº¦ midï¼Œ æˆ‘ä»¬ç»§ç»­æšä¸¾åˆ é™¤çš„ä½ç½® iã€‚

```
def can(mid):
    for i in range(len(t)-mid+1):
        # [i: i+ mid) è¢«åˆ é™¤æ‰äº†ï¼Œå› æ­¤ä¸éœ€è¦è¦†ç›–ï¼Œä¹Ÿå°±æ˜¯è¯´éœ€è¦è¦†ç›–çš„æ˜¯ [0, i) + [i+mid, len(t))
        if pre[i] + suf[i+mid] <= len(s): return True # ä¸€æ—¦ä¸¤è€…å’Œå¤§äº len(s) æ„å‘³ç€ç›¸äº¤ï¼Œ å³ä¸æ»¡è¶³é¢˜æ„
    return False
```

é‚£ä¹ˆå¦‚ä½•æ±‚è§£ pre å’Œ suf å‘¢ï¼Ÿå’Œå‰é¢çš„å­åºåˆ—åŒ¹é…ç±»ä¼¼ï¼Œæˆ‘ä»¬æ¥çœ‹ä»£ç ã€‚ pre å’Œ suf å¤„ç†æ–¹å¼ç±»ä¼¼ï¼Œçœ‹æ‡‚ä¸€ä¸ªï¼Œå¦å¤–ä¸€ä¸ªå°±å¥½æ‡‚äº†ã€‚

```
pre = [len(s)+1] * (len(t))# pre[i] è¡¨ç¤ºåŒ¹é… s[:i] éœ€è¦çš„ s çš„å‰ç¼€é•¿åº¦
suf = [len(s)+1] * (len(t)) # suf[i] è¡¨ç¤ºåŒ¹é… s[i:] éœ€è¦çš„ s çš„åç¼€é•¿åº¦
i = 0
# é¢„å¤„ç† pre
for j in range(len(t)):
    while i < len(s) and s[i] != t[j]:
        i += 1
    if i < len(s):
        pre[j] = i + 1
        i += 1
pre = [0] + pre # ç®€åŒ–é€»è¾‘ï¼Œåœ¨ pre å‰é¢åŠ ä¸€ä¸ª 0
i = len(s) - 1
# é¢„å¤„ç† suf
for j in range(len(t)-1, -1, -1):
    while i > -1 and s[i] != t[j]:
        i -= 1
    if i > -1:
        suf[j] = len(s) - i
        i -= 1
suf += [0] # ç®€åŒ–é€»è¾‘ï¼Œåœ¨ suff åé¢åŠ ä¸€ä¸ª 0
```

æ¨èé¢˜ç›®ï¼š [2565. æœ€å°‘å¾—åˆ†å­åºåˆ—](https://leetcode.cn/problems/subsequence-with-the-minimum-score/)

### æœ€é•¿å…¬å…±å‰ç¼€

**å‰ç½®çŸ¥è¯†ï¼šåŠ¨æ€è§„åˆ’**

å®é™…ä¸Šæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨æœ€é•¿å…¬å…±å‰ç¼€ï¼ˆLCPï¼‰ æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

lcp(i,j) è¡¨ç¤ºå­—ç¬¦ä¸² s ä»ä¸‹æ ‡ i å¼€å§‹çš„åç¼€å’Œä»ä¸‹æ ‡ j å¼€å§‹çš„åç¼€ä¹‹é—´çš„æœ€é•¿å…¬å…±å‰ç¼€ï¼Œé‚£ä¹ˆè½¬ç§»æ–¹ç¨‹ä¸ºï¼š

```
if s[i] == s[j]: lcp(i, j) = lcp(i+1, j+1) + 1
else: lcp(i,j) = 0
```

æ³¨æ„åˆ°çŠ¶æ€ lcp(i,j) ä¾èµ–äºçŠ¶æ€ lcp(i+1,j+1)ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å€’åºæšä¸¾ã€‚

å®Œæ•´æ±‚è§£ lcp çš„ Python ä»£ç å¦‚ä¸‹ï¼š

```
lcp = [[0] * (n + 1) for _ in range(n + 1)]  # lcp[i][j] è¡¨ç¤º s[i:] å’Œ s[j:] çš„æœ€é•¿å…¬å…±å‰ç¼€
for i in range(n - 1, -1, -1):
    for j in range(n - 1, i, -1):
        if s[i] == s[j]:
            lcp[i][j] = lcp[i + 1][j + 1] + 1
```

é¢˜ç›®æ¨èï¼š

- [6195. å¯¹å­—æ¯ä¸²å¯æ‰§è¡Œçš„æœ€å¤§åˆ é™¤æ•°](https://leetcode.cn/problems/maximum-deletions-on-a-string/)

PS: è¿™é“é¢˜ n^3n3 çš„æš´åŠ› dp å¯ä»¥ç›´æ¥è½å‡ºæ¥ï¼Œå’Œä½¿ç”¨ lcp ä¼˜åŒ–æ—¶é—´ç«Ÿç„¶å·®ä¸å¤šã€‚ è¿™å…¶å®æ˜¯æµ‹è¯•ç”¨ä¾‹å¤ªæ°´çš„åŸå› ã€‚é™„ä¸‹ä»£ç ï¼š

```
class Solution:
    def deleteString(self, s: str) -> int:
        n = len(s)
        lcp = [[0] * (n + 1) for _ in range(n + 1)]  # lcp[i][j] è¡¨ç¤º s[i:] å’Œ s[j:] çš„æœ€é•¿å…¬å…±å‰ç¼€
        for i in range(n - 1, -1, -1):
            for j in range(n - 1, i, -1):
                if s[i] == s[j]:
                    lcp[i][j] = lcp[i + 1][j + 1] + 1
        @cache
        def dp(pos):
            if pos == n: return 0
            ans = 1
            for i in range(pos+1, n):
                if lcp[pos][i] >= i - pos:
                # ä¸ä½¿ç”¨ lcp ä¼˜åŒ–å°±æ³¨é‡Šæ‰ä¸Šé¢çš„ä»£ç ï¼Œ ç„¶åæ‰“å¼€ä¸‹é¢çš„ä»£ç å³å¯
                # if s[pos:i] == s[i:i+i-pos]:
                    ans = max(ans, 1 + dp(i))
            return ans
        return dp(0)
```

## æ€»ç»“

å­—ç¬¦ä¸²åŒ¹é…æœ¬è´¨å°±æ˜¯æ±‚ä¸€ä¸ªæ¨¡å¼ä¸²æ˜¯å¦åœ¨ä¸»ä¸²ä¸­å‡ºç°è¿‡ï¼Œä»¥åŠå‡ºç°çš„å…·ä½“ä½ç½®ã€‚æˆ‘ä»¬æœ¬ç« è®²è§£äº†å­—ç¬¦ä¸²åŒ¹é…çš„ä¸‰ç§å¸¸è§æ–¹æ³•ï¼šæš´åŠ›æ³•ï¼ŒRK ç®—æ³•å’Œ KMP ç®—æ³•ã€‚

å…¶ä¸­

- æš´åŠ›æ³•ç®€å•ç›´æ¥
- RK ç®—æ³•å°±æ˜¯å‰é¢æ»‘åŠ¨çª—å£ä¸“é¢˜çš„åº”ç”¨ï¼Œæ ¸å¿ƒåœ¨äºå“ˆå¸Œå‡½æ•°çš„é€‰æ‹©
- KMP åˆ™æ˜¯å‰é¢åŠ¨æ€è§„åˆ’çš„åº”ç”¨ï¼Œæ ¸å¿ƒåœ¨äº next æ•°ç»„çš„ç”Ÿæˆã€‚

è™½ç„¶æœ¬ç« æ˜¯è®²å­—ç¬¦ä¸²çš„åŒ¹é…ï¼Œä½†æ˜¯ä½ å¯ä»¥å°†å…¶è¿›è¡Œç®€å•çš„æ‰©å±•ï¼Œä»¥å®ç°çŸ¥è¯†çš„è¿ç§»ã€‚

æ¯”å¦‚ç»™ä½ ä¸¤ä¸ªæ•°ç»„ A å’Œ Bï¼Œå…¶ä¸­ A ä¸º [1,2,3,4,5] ï¼ŒB ä¸º [2,8,9,10]ã€‚è®©ä½ åœ¨ A ä¸­ æ‰¾åˆ° B çš„æœ€é•¿ç›¸ä¼¼æ•°ç»„ã€‚å…¶ä¸­ç›¸ä¼¼æ•°ç»„æŒ‡çš„æ˜¯ï¼›å¦‚æœæ•°ç»„ A[i], A[i+1] , ... A[j] ä¸ B[p], B[p+1] , ... B[q]ï¼Œæ»¡è¶³ A[i] == B[p] + xï¼ŒA[i+1] == B[p+1] + x, .... A[j] == B[q] + xï¼Œå…¶ä¸­ x ä¸ºä»»æ„æ•°å­—ã€‚

è¿™ä¸ªé¢˜ç›®å¯ä»¥å°† A å’Œ B åšä¸€ä¸ªç®€å•çš„å˜æ¢ï¼Œå˜æ¢ä¹‹åå°±å¯ä»¥çœ‹æˆæ˜¯å­—ç¬¦ä¸²åŒ¹é…ï¼Œå³è®©ä½ åœ¨ A ä¸­æ‰¾ Bã€‚

é‚£ä¹ˆå¦‚ä½•å˜åŒ–å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ç›¸é‚»é¡¹åšå·®ã€‚

```
for i in range(1, len(A)):
  A[i] -= A[i-1]
  B[i] -= B[i-1]
```

ç»è¿‡è¿™æ ·çš„å¤„ç† A å’Œ B å°±å˜ä¸ºäº†ï¼š

```
A = [1,1,1,1,1]
B = [2,1,1,1]
```

å¯ä»¥çœ‹å‡ºé™¤äº†é¦–é¡¹å¤–ï¼ŒA å’Œ B ç›¸ä¼¼æ•°ç»„çš„å€¼æ˜¯ç›¸åŒçš„ã€‚

æˆ‘ä»¬å…ˆä¸çœ‹ A å’Œ B çš„é¦–é¡¹ï¼Œè¿™æ ·çš„è¯æˆ‘ä»¬åªè¦åœ¨ A ä¸­æ‰¾åˆ° [1,1,1] å°±è¡Œäº†ï¼Œæœ€ååœ¨è€ƒè™‘é¦–é¡¹å³å¯ã€‚

æ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨æœ¬ç« çš„æ–¹æ³•æ¥è§£å†³ï¼Œæ¯”å¦‚ RK ç®—æ³•ï¼ˆé€‰æ‹©ä¸€ä¸ªåˆé€‚çš„å“ˆå¸Œå‡½æ•°å³å¯ï¼‰ã€‚

## æ€»ç»“

æœ¬èŠ‚è®²è¿°äº†ä¸‰ç§å­—ç¬¦ä¸²åŒ¹é…ç®—æ³•ï¼Œåˆ†åˆ«ä¸ºæš´åŠ›åŒ¹é…ï¼ŒRKï¼ˆå“ˆå¸ŒåŒ¹é…ï¼‰å’Œ KMPã€‚

- æš´åŠ›è§£æ³•å¿…é¡»è¦ç†è§£ï¼Œä½†ä¸æ¨èåœ¨åšé¢˜ä¸­ä½¿ç”¨ï¼Œé™¤éæ•°æ®é‡è¶³å¤Ÿå°ã€‚
- æœ€æœ€æ¨èæŒæ¡çš„æ˜¯ RKï¼ˆå“ˆå¸ŒåŒ¹é…ï¼‰ï¼Œä¸ç®¡æ˜¯æ€æƒ³è¿˜æ˜¯å¤æ‚åº¦éƒ½éå¸¸ä¼˜ç§€ã€‚
- KMP ä½œä¸ºæ‹”é«˜ï¼Œæœ‰èƒ½åŠ›çš„åŒå­¦å¯ä»¥æŒæ¡ä¸€ä¸‹ã€‚å¦‚æœä»ç„¶å­¦æœ‰ä½™åŠ›å¯ä»¥å°è¯•ä¸‹åé¢çš„æ‰©å±•å†…å®¹ã€‚

## æ‰©å±•

### æ¨èåŠ ç»ƒ

- [792. åŒ¹é…å­åºåˆ—çš„å•è¯æ•°](https://leetcode-cn.com/problems/number-of-matching-subsequences/) è¿™é“é¢˜è™½ç„¶ä¸æ˜¯æ±‚å­ä¸²ï¼Œè€Œæ˜¯å­åºåˆ—ï¼Œç®—æ³•ä¹Ÿä¸èƒ½å¥—ç”¨å½“å‰ç« ã€‚ä½†æ˜¯å´å’Œæœ¬ç« å†…å®¹æœ‰å…³ï¼Œå¤§å®¶å¯ä»¥ç»“åˆç»ƒä¹ ã€‚å¦å¤–è¿˜å¯ä»¥é¡ºä¾¿å¤ä¹ ä¸€ä¸‹å“ˆå¸Œè¡¨ã€‚ å¼ºçƒˆæ¨è ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

> è¿™é“é¢˜èƒ½ä½¿ç”¨å‰ç¼€æ ‘è§£å†³ä¹ˆï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ

- [1392. æœ€é•¿å¿«ä¹å‰ç¼€](https://leetcode.cn/problems/longest-happy-prefix/) è¿™é“é¢˜è™½ç„¶ä¸æ˜¯ç›´æ¥çš„å­—ç¬¦ä¸²åŒ¹é…ï¼Œä½†æ˜¯æˆ‘ä»¬éœ€è¦åˆ¤æ–­å‰ç¼€å’Œåç¼€è¿™â€ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰â€œï¼Œå…¶æœ¬è´¨ä¹Ÿæ˜¯å­—ç¬¦ä¸²åŒ¹é…ã€‚ å¼ºçƒˆæ¨è ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

å…¶ä»–æ¨èé¢˜ç›®ï¼ˆå­¦æœ‰ä½™åŠ›çš„å¯ä»¥å°è¯•ï¼‰ï¼š

- https://leetcode-cn.com/problems/longest-duplicate-substring/
- https://leetcode-cn.com/problems/shortest-palindrome/
- https://leetcode-cn.com/problems/maximum-length-of-repeated-subarray/
- https://leetcode-cn.com/problems/longest-chunked-palindrome-decomposition/
- https://leetcode-cn.com/problems/distinct-echo-substrings/

### åŸºäºæœ‰é™è‡ªåŠ¨æœºçš„å­—ç¬¦ä¸²åŒ¹é…

è¿™ä¸ªç®—æ³•ä»…é™äº†è§£å³å¯ï¼Œè¿™é‡Œä¸åšå±•å¼€ï¼Œæ„Ÿå…´è¶£å¯ä»¥å‚è€ƒ [Finite Automata algorithm for Pattern Searching](https://www.geeksforgeeks.org/finite-automata-algorithm-for-pattern-searching/)

### Z å‡½æ•°ï¼ˆæ‰©å±• KMPï¼‰

- [oi-wiki](https://oi-wiki.org/string/z-func/#_2) ç›¸å…³é¢˜ç›® [6036. æ„é€ å­—ç¬¦ä¸²çš„æ€»å¾—åˆ†å’Œ](https://leetcode-cn.com/problems/sum-of-scores-of-built-strings/)

## å‚è€ƒ

- [æ²¹ç®¡ KMP è®²è§£](https://www.youtube.com/watch?v=GTJr8OvyEVQ)(éœ€ç¿»å¢™)
- [ç»´åŸºç™¾ç§‘](https://zh.wikipedia.org/wiki/å…‹åŠªæ–¯-è«é‡Œæ–¯-æ™®æ‹‰ç‰¹ç®—æ³•)
- [ä»å¤´åˆ°å°¾å½»åº•ç†è§£ KMP](https://blog.csdn.net/v_JULY_v/article/details/7041827)
- [Finite Automata algorithm for Pattern Searching](https://www.geeksforgeeks.org/finite-automata-algorithm-for-pattern-searching/)

